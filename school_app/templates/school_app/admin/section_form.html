<!-- templates/school_app/admin/section_form.html -->

{% extends 'base.html' %}

{% block title %}{% if object %}Edit{% else %}Add{% endif %} Section | Admin | {{ school.name }}{% endblock %}

{% block content %}
<div class="container-fluid py-4">
    <div class="row">
        {% include 'school_app/admin/sidebar.html' %}

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <h1 class="h2">{% if object %}Edit{% else %}Add{% endif %} Section</h1>
            </div>

            <form method="post">
                {% csrf_token %}

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="{{ form.page.id_for_label }}" class="form-label">Page</label>
                        {{ form.page }}
                        {% if form.page.errors %}
                            <div class="text-danger">{{ form.page.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <label for="{{ form.title.id_for_label }}" class="form-label">Title</label>
                        {{ form.title }}
                        {% if form.title.errors %}
                            <div class="text-danger">{{ form.title.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="{{ form.order.id_for_label }}" class="form-label">Order</label>
                        {{ form.order }}
                        {% if form.order.errors %}
                            <div class="text-danger">{{ form.order.errors }}</div>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <label for="{{ form.background_color.id_for_label }}" class="form-label">Background Color</label>
                        <div class="input-group">
                            {{ form.background_color }}
                            <span class="input-group-text color-preview" id="colorPreview"
                                  style="background-color: {% if form.background_color.value %}{{ form.background_color.value }}{% else %}#ffffff{% endif %};"></span>
                        </div>
                        {% if form.background_color.errors %}
                            <div class="text-danger">{{ form.background_color.errors }}</div>
                        {% endif %}
                    </div>
                </div>

                <div class="mb-3">
                    <label for="{{ form.content.id_for_label }}" class="form-label">Content</label>
                    {{ form.content }}
                    {% if form.content.errors %}
                        <div class="text-danger">{{ form.content.errors }}</div>
                    {% endif %}
                </div>

                <div class="mb-3 form-check">
                    {{ form.is_active }}
                    <label class="form-check-label" for="{{ form.is_active.id_for_label }}">Active</label>
                </div>

                <div class="d-grid gap-2 d-md-flex justify-content-md-end">
                    <a href="{% url 'section_list' %}" class="btn btn-secondary">Cancel</a>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </main>
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Update color preview when color changes
        const colorInput = document.getElementById('{{ form.background_color.id_for_label }}');
        const colorPreview = document.getElementById('colorPreview');

        colorInput.addEventListener('input', function() {
            colorPreview.style.backgroundColor = this.value;
        });
    });
</script>

<style>
    .color-preview {
        width: 40px;
        height: 38px;
        border: 1px solid #ced4da;
        border-radius: 0.25rem;
    }
</style>
{% endblock %}